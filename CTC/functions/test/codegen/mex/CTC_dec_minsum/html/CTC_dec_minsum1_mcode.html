<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S2T1U3">u_hat</span> ] = CTC_dec_minsum(<span class="var type1" id="S3T2U6">r</span>, <span class="var type1" id="S4T3U7">state_update_table</span>, <span class="var type1" id="S5T3U8">output_table</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line">             <span class="var type1" id="S6T3U9">neighbours_table</span>, <span class="var type1" id="S7T4U10">modulation_table</span>, <span class="var type1" id="S8T5U11">sigma_w</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line">             <span class="var type1" id="S9T5U12">N</span>, <span class="var type1" id="S10T5U13">n_it</span>, <span class="var type1" id="S11T6U14">p_input_table</span>, <span class="var type1" id="S12T6U15">p_step_table</span>, <span class="var type1" id="S13T2U16">puncturing_pattern</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">% CTC_DECODER: Basic CTC decoding through message passing </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line">    <span class="comment">% CRSC code component params</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line">    <span class="comment">%crsc_k = size(CRSC.P,2);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line">    <span class="comment">%crsc_n = size(CRSC.P,1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line">    <span class="comment">%crsc_v = length(CRSC.G);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line">    <span class="mxinfo " id="T5:U13"><span class="var type1" id="S14T5U19">crsc_k</span> = <span class="mxinfo " id="T5:U15">2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line">    <span class="mxinfo " id="T5:U16"><span class="var type1" id="S15T5U23">crsc_n</span> = <span class="mxinfo " id="T5:U18">3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line">    <span class="mxinfo " id="T5:U19"><span class="var type1" id="S16T5U27">crsc_v</span> = <span class="mxinfo " id="T5:U21">3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">%   piece_const = log(1+exp(-(0:5)));% TO IMPLEMENT AND SEE THE DIFFERENCE!</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line">    <span class="comment">% De-puncturing of the received sequence in a N x (2n-k) matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line">    <span class="mxinfo " id="T7:U22"><span class="var type1" id="S17T7U31">r_dep</span> = <span class="mxinfo " id="T7:U24">zeros(<span class="var type1" id="S9T5U34">N</span>, <span class="mxinfo " id="T5:U26">2*<span class="var type1" id="S15T5U38">crsc_n</span>-<span class="var type1" id="S14T5U39">crsc_k</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line">    <span class="mxinfo " id="T5:U29"><span class="var type1" id="S19T5U42">index_r</span> = <span class="mxinfo " id="T5:U31">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line">    <span class="mxinfo " id="T5:U32"><span class="var type1" id="S20T5U46">index_p</span> = <span class="mxinfo " id="T5:U34">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S21T5U50">i</span> = <span class="mxinfo " id="T5:U36">0</span> : <span class="mxinfo " id="T5:U37"><span class="var type1" id="S9T5U54">N</span> -<span class="mxinfo " id="T5:U39">1</span></span>  </span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line">         <span class="keyword">for</span> <span class="var type1" id="S22T5U58">j</span> = <span class="mxinfo " id="T5:U41">0</span> : 2*<span class="var type1" id="S15T5U65">crsc_n</span>-<span class="var type1" id="S14T5U66">crsc_k</span>-1</span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line">            <span class="keyword">if</span> (<span class="mxinfo " id="T8:U44"><span class="mxinfo " id="T5:U45"><span class="var type1" id="S13T2U73">puncturing_pattern</span>(<span class="mxinfo " id="T5:U47"><span class="var type1" id="S20T5U75">index_p</span>+<span class="mxinfo " id="T5:U49">1</span></span>)</span> == <span class="mxinfo " id="T5:U50">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line">                 <span class="mxinfo " id="T5:U51"><span class="mxinfo " id="T5:U52"><span class="var type1" id="S17T7U81">r_dep</span>(<span class="mxinfo " id="T5:U54"><span class="var type1" id="S21T5U83">i</span>+<span class="mxinfo " id="T5:U56">1</span></span>, <span class="mxinfo " id="T5:U57"><span class="var type1" id="S22T5U86">j</span>+<span class="mxinfo " id="T5:U59">1</span></span>)</span> = <span class="mxinfo " id="T5:U60"><span class="var type1" id="S3T2U89">r</span>(<span class="mxinfo " id="T5:U62"><span class="var type1" id="S19T5U91">index_r</span>+<span class="mxinfo " id="T5:U64">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line">                 <span class="mxinfo " id="T5:U65"><span class="var type1" id="S19T5U95">index_r</span> = <span class="mxinfo " id="T5:U67"><span class="var type1" id="S19T5U97">index_r</span> + <span class="mxinfo " id="T5:U69">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line">            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line">                 <span class="mxinfo " id="T5:U70"><span class="mxinfo " id="T5:U71"><span class="var type1" id="S17T7U103">r_dep</span>(<span class="mxinfo " id="T5:U73"><span class="var type1" id="S21T5U105">i</span>+<span class="mxinfo " id="T5:U75">1</span></span>, <span class="mxinfo " id="T5:U76"><span class="var type1" id="S22T5U108">j</span>+<span class="mxinfo " id="T5:U78">1</span></span>)</span> = <span class="mxinfo " id="T5:U79">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line">            <span class="mxinfo " id="T5:U80"><span class="var type1" id="S20T5U113">index_p</span> = <span class="mxinfo " id="T5:U82"><span class="var type1" id="S20T5U115">index_p</span> + <span class="mxinfo " id="T5:U84">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line">         <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line">    <span class="comment">% MESSAGE PASSING DECODING ALGORITHM</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line">    <span class="comment">% 1. INITIALIZATION</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line">    <span class="comment">% 1.1 The q vector is initialized to the a priori probability,</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line">    <span class="mxinfo " id="T9:U85"><span class="var type1" id="S23T9U119">q</span> = <span class="mxinfo " id="T9:U87">-<span class="mxinfo " id="T9:U88">log(<span class="mxinfo " id="T9:U89"><span class="mxinfo " id="T9:U90">ones(<span class="mxinfo " id="T10:U91">2^<span class="var type1" id="S14T5U128">crsc_k</span></span>, <span class="var type1" id="S9T5U129">N</span>)</span>./(<span class="mxinfo " id="T5:U94">2^<span class="var type1" id="S14T5U133">crsc_k</span></span>)</span>)</span></span></span>; <span class="comment">% Row: input  | Column: step l</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line">    <span class="mxinfo " id="T9:U96"><span class="var type1" id="S23T9U136">q</span> = <span class="mxinfo " id="T9:U98">bsxfun(@minus, <span class="var type1" id="S23T9U141">q</span>, <span class="mxinfo " id="T11:U100">min(<span class="var type1" id="S23T9U144">q</span>)</span>)</span></span>; <span class="comment">% Normalization</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line">    <span class="comment">% 1.2 Two g vectors: g1 for the upper code and g2 for the lower one</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line">    <span class="mxinfo " id="T12:U102"><span class="var type1" id="S29T12U147">g1</span> = <span class="mxinfo " id="T12:U104">zeros(<span class="mxinfo " id="T5:U105">2^<span class="var type1" id="S15T5U152">crsc_n</span></span>, <span class="var type1" id="S9T5U153">N</span>)</span></span>;      <span class="comment">% Row: output | Column: step l in blocks</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line">    <span class="mxinfo " id="T12:U108"><span class="var type1" id="S30T12U156">g2</span> = <span class="mxinfo " id="T12:U110">zeros(<span class="mxinfo " id="T5:U111">2^<span class="var type1" id="S15T5U161">crsc_n</span></span>, <span class="var type1" id="S9T5U162">N</span>)</span></span>;      <span class="comment">% Row: output | Column: step l in blocks   </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line">    <span class="comment">% To compute g2 we use must rebuild the part due to the lower encoder</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line">    <span class="comment">% using the inverse of the permutation matrix P^-1 = P^T</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line">    <span class="mxinfo " id="T13:U114"><span class="var type1" id="S31T13U165">r1</span> = <span class="mxinfo " id="T13:U116"><span class="var type1" id="S17T7U167">r_dep</span>(<span class="mxinfo " id="T14:U118">:</span>,<span class="mxinfo " id="T15:U119">1:<span class="var type1" id="S15T5U171">crsc_n</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line">    <span class="comment">%r2 = [reshape(P*(reshape(r_dep(:,[1,2]).', 1,[]).'),2,[]).',r_dep(:, crsc_n+1:end)];</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line">    <span class="mxinfo " id="T1:U121"><span class="var type1" id="S32T1U174">r2</span> = <span class="mxinfo " id="T1:U123"><span class="var type1" id="S17T7U176">r_dep</span>(<span class="mxinfo " id="T14:U125">:</span>, <span class="mxinfo " id="T10:U126"><span class="var type1" id="S15T5U180">crsc_n</span>+1:end</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S34T5U186">l</span> = <span class="mxinfo " id="T5:U129">0</span> : <span class="mxinfo " id="T5:U130"><span class="var type1" id="S9T5U190">N</span> - <span class="mxinfo " id="T5:U132">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line">        <span class="keyword">for</span>  <span class="var type1" id="S35T5U194">y</span> = <span class="mxinfo " id="T5:U134">0</span> : 2^<span class="var type1" id="S15T5U200">crsc_n</span> - 1</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line">           <span class="mxinfo " id="T16:U136"><span class="var type1" id="S36T16U204">mod_y</span> = <span class="mxinfo " id="T16:U138"><span class="mxinfo " id="T16:U139"><span class="var type1" id="S7T4U207">modulation_table</span>(<span class="mxinfo " id="T5:U141"><span class="var type1" id="S35T5U209">y</span>+<span class="mxinfo " id="T5:U143">1</span></span>,<span class="mxinfo " id="T15:U144">:</span>)</span>.*<span class="mxinfo " id="T16:U145"><span class="mxinfo " id="T17:U146"><span class="var type1" id="S13T2U214">puncturing_pattern</span>(<span class="mxinfo " id="T17:U148"><span class="mxinfo " id="T5:U149"><span class="mxinfo " id="T5:U150"><span class="var type1" id="S34T5U218">l</span>*(<span class="mxinfo " id="T5:U152"><span class="mxinfo " id="T5:U153"><span class="mxinfo " id="T5:U154">2</span>*<span class="var type1" id="S15T5U223">crsc_n</span></span>-<span class="var type1" id="S14T5U224">crsc_k</span></span>)</span>+1</span>:<span class="mxinfo " id="T5:U157"><span class="var type1" id="S34T5U228">l</span>*(2*<span class="var type1" id="S15T5U233">crsc_n</span>-<span class="var type1" id="S14T5U234">crsc_k</span>)+<span class="var type1" id="S15T5U235">crsc_n</span></span></span>)</span>.'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line">            <span class="mxinfo " id="T5:U162"><span class="mxinfo " id="T5:U163"><span class="var type1" id="S29T12U239">g1</span>(<span class="mxinfo " id="T5:U165"><span class="var type1" id="S35T5U241">y</span>+<span class="mxinfo " id="T5:U167">1</span></span>, <span class="mxinfo " id="T5:U168"><span class="var type1" id="S34T5U244">l</span>+<span class="mxinfo " id="T5:U170">1</span></span>)</span> = <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line">                    <span class="mxinfo " id="T5:U171">sum(<span class="mxinfo " id="T16:U172"><span class="mxinfo " id="T16:U173">abs(<span class="mxinfo " id="T16:U174"><span class="mxinfo " id="T16:U175"><span class="var type1" id="S31T13U253">r1</span>(<span class="mxinfo " id="T5:U177"><span class="var type1" id="S34T5U255">l</span>+<span class="mxinfo " id="T5:U179">1</span></span>,<span class="mxinfo " id="T15:U180">:</span>)</span> - <span class="var type1" id="S36T16U258">mod_y</span></span>)</span>.^2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line">            <span class="mxinfo " id="T5:U182"><span class="mxinfo " id="T5:U183"><span class="var type1" id="S30T12U263">g2</span>(<span class="mxinfo " id="T5:U185"><span class="var type1" id="S35T5U265">y</span>+<span class="mxinfo " id="T5:U187">1</span></span>, <span class="mxinfo " id="T5:U188"><span class="var type1" id="S34T5U268">l</span>+<span class="mxinfo " id="T5:U190">1</span></span>)</span> = <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line">                    <span class="mxinfo " id="T5:U191">sum(<span class="mxinfo " id="T5:U192"><span class="mxinfo " id="T5:U193">abs(<span class="mxinfo " id="T5:U194"><span class="mxinfo " id="T5:U195"><span class="var type1" id="S32T1U277">r2</span>(<span class="mxinfo " id="T5:U197"><span class="var type1" id="S34T5U279">l</span>+<span class="mxinfo " id="T5:U199">1</span></span>,<span class="mxinfo " id="T10:U200">:</span>)</span> - <span class="mxinfo " id="T5:U201"><span class="var type1" id="S36T16U283">mod_y</span>(<span class="mxinfo " id="T5:U203"><span class="var type1" id="S14T5U286">crsc_k</span>+1:<span class="var type1" id="S15T5U288">crsc_n</span></span>)</span></span>)</span>.^2</span>)</span></span>;    </span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line">    <span class="mxinfo " id="T12:U206"><span class="var type1" id="S29T12U292">g1</span> = <span class="mxinfo " id="T12:U208"><span class="mxinfo " id="T5:U209"><span class="mxinfo " id="T5:U210">1</span>/(<span class="mxinfo " id="T5:U211"><span class="mxinfo " id="T5:U212">2</span>*<span class="mxinfo " id="T5:U213"><span class="var type1" id="S8T5U300">sigma_w</span>^2</span></span>)</span>.*<span class="var type1" id="S29T12U302">g1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line">    <span class="mxinfo " id="T12:U216"><span class="var type1" id="S30T12U305">g2</span> = <span class="mxinfo " id="T12:U218"><span class="mxinfo " id="T5:U219"><span class="mxinfo " id="T5:U220">1</span>/(<span class="mxinfo " id="T5:U221"><span class="mxinfo " id="T5:U222">2</span>*<span class="mxinfo " id="T5:U223"><span class="var type1" id="S8T5U313">sigma_w</span>^2</span></span>)</span>.*<span class="var type1" id="S30T12U315">g2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line">    <span class="mxinfo " id="T12:U226"><span class="var type1" id="S29T12U318">g1</span> = <span class="mxinfo " id="T12:U228">bsxfun(@minus, <span class="var type1" id="S29T12U323">g1</span>, <span class="mxinfo " id="T11:U230">min(<span class="var type1" id="S29T12U326">g1</span>)</span>)</span></span>; <span class="comment">% Normalization</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line">    <span class="mxinfo " id="T12:U232"><span class="var type1" id="S30T12U329">g2</span> = <span class="mxinfo " id="T12:U234">bsxfun(@minus, <span class="var type1" id="S30T12U334">g2</span>, <span class="mxinfo " id="T11:U236">min(<span class="var type1" id="S30T12U337">g2</span>)</span>)</span></span>; <span class="comment">% Normalization</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line">    <span class="mxinfo " id="T9:U238"><span class="var type1" id="S39T9U340">E2</span> = <span class="mxinfo " id="T9:U240">zeros(<span class="mxinfo " id="T5:U241">2^<span class="var type1" id="S14T5U345">crsc_k</span></span>, <span class="var type1" id="S9T5U346">N</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line">    <span class="mxinfo " id="T9:U244"><span class="var type1" id="S40T9U349">E1</span> = <span class="mxinfo " id="T9:U246">zeros(<span class="mxinfo " id="T5:U247">2^<span class="var type1" id="S14T5U354">crsc_k</span></span>, <span class="var type1" id="S9T5U355">N</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S41T5U358">cont</span> = <span class="mxinfo " id="T5:U251">1</span> : <span class="var type1" id="S10T5U361">n_it</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line">        <span class="comment">% 2 BCJR ALGORITHM ON THE UPPER CODE</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line">        <span class="comment">% 2.0 BCJR initialization </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line">        <span class="mxinfo " id="T12:U253"><span class="var type1" id="S42T12U364">backward_matrix</span> = <span class="mxinfo " id="T12:U255">Inf(<span class="mxinfo " id="T10:U256">2^<span class="var type1" id="S16T5U369">crsc_v</span></span>, <span class="var type1" id="S9T5U370">N</span>)</span></span>;   <span class="comment">% Row: state  | Column: step l</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line">        <span class="mxinfo " id="T12:U259"><span class="var type1" id="S44T12U373">forward_matrix</span> = <span class="mxinfo " id="T12:U261">Inf(<span class="mxinfo " id="T5:U262">2^<span class="var type1" id="S16T5U378">crsc_v</span></span>, <span class="var type1" id="S9T5U379">N</span>)</span></span>;    <span class="comment">% Row: state  | Column: step l</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line">        <span class="mxinfo " id="T9:U265"><span class="var type1" id="S45T9U382">extrinsic_matrix</span> = <span class="mxinfo " id="T9:U267">Inf(<span class="mxinfo " id="T5:U268">2^<span class="var type1" id="S14T5U387">crsc_k</span></span>, <span class="var type1" id="S9T5U388">N</span>)</span></span>;  <span class="comment">% Row: input  | Column: step l</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line">        <span class="mxinfo " id="T9:U271"><span class="var type1" id="S46T9U391">mu_eq</span> = <span class="mxinfo " id="T9:U273"><span class="var type1" id="S39T9U393">E2</span> + <span class="var type1" id="S23T9U394">q</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line">        <span class="mxinfo " id="T9:U276"><span class="var type1" id="S46T9U397">mu_eq</span> = <span class="mxinfo " id="T9:U278">bsxfun(@minus, <span class="var type1" id="S46T9U402">mu_eq</span>, <span class="mxinfo " id="T11:U280">min(<span class="var type1" id="S46T9U405">mu_eq</span>)</span>)</span></span>;  <span class="comment">% Normalization</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line">        <span class="comment">% 2.1 Backward messages update</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line">        <span class="mxinfo " id="T5:U282"><span class="mxinfo " id="T5:U283"><span class="var type1" id="S42T12U409">backward_matrix</span>(<span class="mxinfo " id="T5:U285">1</span>,<span class="mxinfo " id="T5:U286">end</span>)</span> = <span class="mxinfo " id="T5:U287">0</span></span>; <span class="comment">% Starting with B_(N-1)(s_0) = 0 </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S34T5U416">l</span> = <span class="mxinfo " id="T5:U289"><span class="mxinfo " id="T5:U290"><span class="mxinfo " id="T5:U291">2</span>*<span class="var type1" id="S9T5U422">N</span></span>-<span class="mxinfo " id="T5:U293">1</span></span> : <span class="mxinfo " id="T5:U294">-1</span> : <span class="mxinfo " id="T5:U295">1</span>      <span class="comment">% This is a matlab matrix index</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line">            <span class="mxinfo " id="T5:U296"><span class="var type1" id="S47T5U429">index</span> = <span class="mxinfo " id="T5:U298">mod(<span class="var type1" id="S34T5U432">l</span>,<span class="var type1" id="S9T5U433">N</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line">            <span class="keyword">for</span> <span class="var type1" id="S49T5U436">s</span> = <span class="mxinfo " id="T5:U302">0</span> : 2^<span class="var type1" id="S16T5U442">crsc_v</span> - 1  <span class="comment">% s_l</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line">                <span class="mxinfo " id="T5:U304"><span class="var type1" id="S50T5U446">minimum</span> = <span class="mxinfo " id="T5:U306">Inf</span></span>;       <span class="comment">% Sum over u </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line">                <span class="keyword">for</span> <span class="var type1" id="S51T5U451">u</span> = <span class="mxinfo " id="T5:U308">0</span> : 2^<span class="var type1" id="S14T5U457">crsc_k</span> - 1 </span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line">                    <span class="mxinfo " id="T5:U310"><span class="var type1" id="S52T5U461">ql_u</span> = <span class="mxinfo " id="T5:U312"><span class="var type1" id="S46T9U463">mu_eq</span>(<span class="mxinfo " id="T5:U314"><span class="var type1" id="S51T5U465">u</span>+<span class="mxinfo " id="T5:U316">1</span></span>, <span class="mxinfo " id="T5:U317"><span class="var type1" id="S47T5U468">index</span>+<span class="mxinfo " id="T5:U319">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line">                    <span class="mxinfo " id="T5:U320"><span class="var type1" id="S35T5U472">y</span> = <span class="mxinfo " id="T5:U322"><span class="var type1" id="S5T3U474">output_table</span>(<span class="mxinfo " id="T5:U324"><span class="var type1" id="S49T5U476">s</span>+<span class="mxinfo " id="T5:U326">1</span></span>, <span class="mxinfo " id="T5:U327"><span class="var type1" id="S51T5U479">u</span>+<span class="mxinfo " id="T5:U329">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line">                    <span class="mxinfo " id="T5:U330"><span class="var type1" id="S53T5U483">gl_y</span> = <span class="mxinfo " id="T5:U332"><span class="var type1" id="S29T12U485">g1</span>(<span class="mxinfo " id="T5:U334"><span class="var type1" id="S35T5U487">y</span>+<span class="mxinfo " id="T5:U336">1</span></span>, <span class="mxinfo " id="T5:U337"><span class="var type1" id="S47T5U490">index</span>+<span class="mxinfo " id="T5:U339">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line">                    <span class="mxinfo " id="T5:U340"><span class="var type1" id="S54T5U494">s_n</span>  = <span class="mxinfo " id="T5:U342"><span class="var type1" id="S4T3U496">state_update_table</span>(<span class="mxinfo " id="T5:U344"><span class="var type1" id="S49T5U498">s</span>+<span class="mxinfo " id="T5:U346">1</span></span>, <span class="mxinfo " id="T5:U347"><span class="var type1" id="S51T5U501">u</span>+<span class="mxinfo " id="T5:U349">1</span></span>)</span></span>;    <span class="comment">% s_(l+1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">                    <span class="mxinfo " id="T5:U350"><span class="var type1" id="S55T5U505">B_n</span> = <span class="mxinfo " id="T5:U352"><span class="var type1" id="S42T12U507">backward_matrix</span>(<span class="mxinfo " id="T5:U354"><span class="var type1" id="S54T5U509">s_n</span>+<span class="mxinfo " id="T5:U356">1</span></span>, <span class="mxinfo " id="T5:U357"><span class="var type1" id="S47T5U512">index</span>+<span class="mxinfo " id="T5:U359">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">                    <span class="mxinfo " id="T5:U360"><span class="var type1" id="S56T5U516">add</span> = <span class="mxinfo " id="T5:U362"><span class="mxinfo " id="T5:U363"><span class="var type1" id="S55T5U519">B_n</span> + <span class="var type1" id="S53T5U520">gl_y</span></span> + <span class="var type1" id="S52T5U521">ql_u</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line">                    <span class="comment">% TO IMPLEMENT: PIECEWISE CONSTANT APPROXIMATION</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line">                    <span class="mxinfo " id="T5:U367"><span class="var type1" id="S50T5U524">minimum</span> = <span class="mxinfo " id="T5:U369">min(<span class="mxinfo " id="T18:U370">[<span class="var type1" id="S50T5U529">minimum</span>, <span class="var type1" id="S56T5U530">add</span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">                <span class="keyword">if</span> <span class="mxinfo " id="T8:U373"><span class="var type1" id="S47T5U534">index</span> == <span class="mxinfo " id="T5:U375">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">                    <span class="mxinfo " id="T5:U376"><span class="var type1" id="S57T5U538">index2</span> = <span class="var type1" id="S9T5U539">N</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">                <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">                    <span class="mxinfo " id="T5:U379"><span class="var type1" id="S57T5U543">index2</span> = <span class="var type1" id="S47T5U544">index</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">                <span class="mxinfo " id="T5:U382"><span class="mxinfo " id="T5:U383"><span class="var type1" id="S42T12U548">backward_matrix</span>(<span class="mxinfo " id="T5:U385"><span class="var type1" id="S49T5U550">s</span>+<span class="mxinfo " id="T5:U387">1</span></span>, <span class="var type1" id="S57T5U552">index2</span>)</span> = <span class="var type1" id="S50T5U553">minimum</span></span>;           </span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">           <span class="mxinfo " id="T19:U390"><span class="mxinfo " id="T19:U391"><span class="var type1" id="S42T12U557">backward_matrix</span>(<span class="mxinfo " id="T20:U393">:</span>, <span class="var type1" id="S57T5U559">index2</span>)</span> = <span class="mxinfo " id="T19:U395"><span class="mxinfo " id="T19:U396"><span class="var type1" id="S42T12U562">backward_matrix</span>(<span class="mxinfo " id="T20:U398">:</span>, <span class="var type1" id="S57T5U564">index2</span>)</span> <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">                         - <span class="mxinfo " id="T5:U400">min(<span class="mxinfo " id="T19:U401"><span class="var type1" id="S42T12U568">backward_matrix</span>(<span class="mxinfo " id="T20:U403">:</span>, <span class="var type1" id="S57T5U570">index2</span>)</span>)</span></span></span>; <span class="comment">% Normalization</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line">        <span class="comment">% 2.2 Forward messages update</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">        <span class="mxinfo " id="T5:U405"><span class="mxinfo " id="T5:U406"><span class="var type1" id="S44T12U574">forward_matrix</span>(<span class="mxinfo " id="T5:U408">1</span>,<span class="mxinfo " id="T5:U409">1</span>)</span> = <span class="mxinfo " id="T5:U410">0</span></span>; <span class="comment">% Starting with F_0 (s_0) = 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S34T5U580">l</span> = <span class="mxinfo " id="T5:U412">2</span>:<span class="mxinfo " id="T5:U413"><span class="mxinfo " id="T5:U414">2</span>*<span class="var type1" id="S9T5U585">N</span></span>            <span class="comment">% This is a matlab matrix index</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line">            <span class="mxinfo " id="T5:U416"><span class="var type1" id="S47T5U588">index</span> = <span class="mxinfo " id="T5:U418">mod(<span class="mxinfo " id="T5:U419"><span class="var type1" id="S34T5U592">l</span>-<span class="mxinfo " id="T5:U421">1</span></span>, <span class="var type1" id="S9T5U594">N</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T8:U423"><span class="var type1" id="S47T5U598">index</span> == <span class="mxinfo " id="T5:U425">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">                <span class="mxinfo " id="T5:U426"><span class="var type1" id="S57T5U602">index2</span> = <span class="var type1" id="S9T5U603">N</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">            <span class="keyword">else</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line">                <span class="mxinfo " id="T5:U429"><span class="var type1" id="S57T5U607">index2</span> = <span class="var type1" id="S47T5U608">index</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">            <span class="keyword">for</span> <span class="var type1" id="S49T5U611">s</span> = <span class="mxinfo " id="T5:U433">0</span> : 2^<span class="var type1" id="S16T5U617">crsc_v</span> - 1  <span class="comment">% s_(l+1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line">                <span class="mxinfo " id="T5:U435"><span class="var type1" id="S50T5U621">minimum</span> = <span class="mxinfo " id="T5:U437">Inf</span></span>;        <span class="comment">% Sum over the neighbours of s</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line">                <span class="keyword">for</span> <span class="var type1" id="S58T5U626">u_p</span> = <span class="mxinfo " id="T5:U439">0</span> : 2^<span class="var type1" id="S14T5U632">crsc_k</span> - 1</span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line">                    <span class="mxinfo " id="T5:U441"><span class="var type1" id="S52T5U636">ql_u</span> = <span class="mxinfo " id="T5:U443"><span class="var type1" id="S46T9U638">mu_eq</span>(<span class="mxinfo " id="T5:U445"><span class="var type1" id="S58T5U640">u_p</span>+<span class="mxinfo " id="T5:U447">1</span></span>, <span class="var type1" id="S57T5U642">index2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line">                    <span class="mxinfo " id="T5:U449"><span class="var type1" id="S59T5U645">s_p</span> = <span class="mxinfo " id="T5:U451"><span class="var type1" id="S6T3U647">neighbours_table</span>(<span class="mxinfo " id="T5:U453"><span class="var type1" id="S49T5U649">s</span>+<span class="mxinfo " id="T5:U455">1</span></span>, <span class="mxinfo " id="T5:U456"><span class="var type1" id="S58T5U652">u_p</span>+<span class="mxinfo " id="T5:U458">1</span></span>)</span></span>;  <span class="comment">% s_l</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line">                    <span class="mxinfo " id="T5:U459"><span class="var type1" id="S35T5U656">y</span> = <span class="mxinfo " id="T5:U461"><span class="var type1" id="S5T3U658">output_table</span>(<span class="mxinfo " id="T5:U463"><span class="var type1" id="S59T5U660">s_p</span>+<span class="mxinfo " id="T5:U465">1</span></span>, <span class="mxinfo " id="T5:U466"><span class="var type1" id="S58T5U663">u_p</span>+<span class="mxinfo " id="T5:U468">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line">                    <span class="mxinfo " id="T5:U469"><span class="var type1" id="S53T5U667">gl_y</span> = <span class="mxinfo " id="T5:U471"><span class="var type1" id="S29T12U669">g1</span>(<span class="mxinfo " id="T5:U473"><span class="var type1" id="S35T5U671">y</span>+<span class="mxinfo " id="T5:U475">1</span></span>, <span class="var type1" id="S57T5U673">index2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line">                    <span class="mxinfo " id="T5:U477"><span class="var type1" id="S60T5U676">F_p</span> = <span class="mxinfo " id="T5:U479"><span class="var type1" id="S44T12U678">forward_matrix</span>(<span class="mxinfo " id="T5:U481"><span class="var type1" id="S59T5U680">s_p</span>+<span class="mxinfo " id="T5:U483">1</span></span>, <span class="var type1" id="S57T5U682">index2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line">                    <span class="mxinfo " id="T5:U485"><span class="var type1" id="S56T5U685">add</span> = <span class="mxinfo " id="T5:U487"><span class="mxinfo " id="T5:U488"><span class="var type1" id="S60T5U688">F_p</span> + <span class="var type1" id="S53T5U689">gl_y</span></span> + <span class="var type1" id="S52T5U690">ql_u</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line">                    <span class="comment">% TO IMPLEMENT: PIECEWISE CONSTANT APPROXIMATION</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line">                    <span class="mxinfo " id="T5:U492"><span class="var type1" id="S50T5U693">minimum</span> = <span class="mxinfo " id="T5:U494">min(<span class="mxinfo " id="T18:U495">[<span class="var type1" id="S50T5U698">minimum</span>, <span class="var type1" id="S56T5U699">add</span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line">                <span class="mxinfo " id="T5:U498"><span class="mxinfo " id="T5:U499"><span class="var type1" id="S44T12U703">forward_matrix</span>(<span class="mxinfo " id="T5:U501"><span class="var type1" id="S49T5U705">s</span>+<span class="mxinfo " id="T5:U503">1</span></span>, <span class="mxinfo " id="T5:U504"><span class="var type1" id="S47T5U708">index</span>+<span class="mxinfo " id="T5:U506">1</span></span>)</span> = <span class="var type1" id="S50T5U710">minimum</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line">            <span class="mxinfo " id="T19:U508"><span class="mxinfo " id="T19:U509"><span class="var type1" id="S44T12U714">forward_matrix</span>(<span class="mxinfo " id="T20:U511">:</span>, <span class="mxinfo " id="T5:U512"><span class="var type1" id="S47T5U717">index</span>+<span class="mxinfo " id="T5:U514">1</span></span>)</span> = <span class="mxinfo " id="T19:U515"><span class="mxinfo " id="T19:U516"><span class="var type1" id="S44T12U721">forward_matrix</span>(<span class="mxinfo " id="T20:U518">:</span>, <span class="mxinfo " id="T5:U519"><span class="var type1" id="S47T5U724">index</span>+<span class="mxinfo " id="T5:U521">1</span></span>)</span> - <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line">                        <span class="mxinfo " id="T5:U522">min(<span class="mxinfo " id="T19:U523"><span class="var type1" id="S44T12U729">forward_matrix</span>(<span class="mxinfo " id="T20:U525">:</span>, <span class="mxinfo " id="T5:U526"><span class="var type1" id="S47T5U732">index</span>+<span class="mxinfo " id="T5:U528">1</span></span>)</span>)</span></span></span>; <span class="comment">% Normalization</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line">        <span class="comment">% 2.3 Extrinsic message update</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line">        <span class="mxinfo " id="T5:U529"><span class="var type1" id="S61T5U736">index_b</span> = <span class="mxinfo " id="T5:U531">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line">        <span class="mxinfo " id="T5:U532"><span class="var type1" id="S62T5U740">index_f</span> = <span class="mxinfo " id="T5:U534">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S34T5U744">l</span> = <span class="mxinfo " id="T5:U536">1</span> : <span class="var type1" id="S9T5U747">N</span>                             <span class="comment">% This is a matlab index!</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line">            <span class="keyword">for</span> <span class="var type1" id="S51T5U750">u</span> = <span class="mxinfo " id="T5:U539">0</span> : 2^<span class="var type1" id="S14T5U756">crsc_k</span> -1</span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line">                <span class="mxinfo " id="T5:U541"><span class="var type1" id="S50T5U760">minimum</span> = <span class="mxinfo " id="T5:U543">Inf</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line">                <span class="keyword">for</span> <span class="var type1" id="S49T5U765">s</span> = <span class="mxinfo " id="T5:U545">0</span> : 2^<span class="var type1" id="S16T5U771">crsc_v</span> -1</span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line">                    <span class="mxinfo " id="T5:U547"><span class="var type1" id="S54T5U775">s_n</span> = <span class="mxinfo " id="T5:U549"><span class="var type1" id="S4T3U777">state_update_table</span>(<span class="mxinfo " id="T5:U551"><span class="var type1" id="S49T5U779">s</span>+<span class="mxinfo " id="T5:U553">1</span></span>, <span class="mxinfo " id="T5:U554"><span class="var type1" id="S51T5U782">u</span>+<span class="mxinfo " id="T5:U556">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line">                    <span class="mxinfo " id="T5:U557"><span class="var type1" id="S35T5U786">y</span> = <span class="mxinfo " id="T5:U559"><span class="var type1" id="S5T3U788">output_table</span>(<span class="mxinfo " id="T5:U561"><span class="var type1" id="S49T5U790">s</span>+<span class="mxinfo " id="T5:U563">1</span></span>, <span class="mxinfo " id="T5:U564"><span class="var type1" id="S51T5U793">u</span>+<span class="mxinfo " id="T5:U566">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line">                    <span class="mxinfo " id="T5:U567"><span class="var type1" id="S53T5U797">gl_y</span> = <span class="mxinfo " id="T5:U569"><span class="var type1" id="S29T12U799">g1</span>(<span class="mxinfo " id="T5:U571"><span class="var type1" id="S35T5U801">y</span>+<span class="mxinfo " id="T5:U573">1</span></span>, <span class="var type1" id="S34T5U803">l</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line">                    <span class="mxinfo " id="T5:U575"><span class="var type1" id="S63T5U806">F</span> = <span class="mxinfo " id="T5:U577"><span class="var type1" id="S44T12U808">forward_matrix</span>(<span class="mxinfo " id="T5:U579"><span class="var type1" id="S49T5U810">s</span>+<span class="mxinfo " id="T5:U581">1</span></span>, <span class="var type1" id="S62T5U812">index_f</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line">                    <span class="mxinfo " id="T5:U583"><span class="var type1" id="S64T5U815">B</span> = <span class="mxinfo " id="T5:U585"><span class="var type1" id="S42T12U817">backward_matrix</span>(<span class="mxinfo " id="T5:U587"><span class="var type1" id="S54T5U819">s_n</span>+<span class="mxinfo " id="T5:U589">1</span></span>, <span class="var type1" id="S61T5U821">index_b</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line">                    <span class="mxinfo " id="T5:U591"><span class="var type1" id="S56T5U824">add</span> = <span class="mxinfo " id="T5:U593"><span class="mxinfo " id="T5:U594"><span class="var type1" id="S63T5U827">F</span> + <span class="var type1" id="S64T5U828">B</span></span> + <span class="var type1" id="S53T5U829">gl_y</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line">                    <span class="comment">% TO IMPLEMENT: PIECEWISE CONSTANT APPROXIMATION</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line">                    <span class="mxinfo " id="T5:U598"><span class="var type1" id="S50T5U832">minimum</span> = <span class="mxinfo " id="T5:U600">min(<span class="mxinfo " id="T18:U601">[<span class="var type1" id="S50T5U837">minimum</span>, <span class="var type1" id="S56T5U838">add</span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line">                <span class="mxinfo " id="T5:U604"><span class="mxinfo " id="T5:U605"><span class="var type1" id="S45T9U842">extrinsic_matrix</span>(<span class="mxinfo " id="T5:U607"><span class="var type1" id="S51T5U844">u</span>+<span class="mxinfo " id="T5:U609">1</span></span>, <span class="var type1" id="S34T5U846">l</span>)</span> = <span class="var type1" id="S50T5U847">minimum</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line">            <span class="mxinfo " id="T5:U612"><span class="var type1" id="S62T5U850">index_f</span> = <span class="mxinfo " id="T5:U614"><span class="var type1" id="S62T5U852">index_f</span> + <span class="mxinfo " id="T5:U616">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line">            <span class="mxinfo " id="T5:U617"><span class="var type1" id="S61T5U856">index_b</span> = <span class="mxinfo " id="T5:U619"><span class="var type1" id="S61T5U858">index_b</span> + <span class="mxinfo " id="T5:U621">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line">            <span class="comment">% index_b = mod(index_b + 1, N);        </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line">        <span class="mxinfo " id="T9:U622"><span class="var type1" id="S40T9U862">E1</span> = <span class="var type1" id="S45T9U863">extrinsic_matrix</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155">155</a></span><span class="line">        <span class="mxinfo " id="T9:U625"><span class="var type1" id="S40T9U866">E1</span> = <span class="mxinfo " id="T9:U627">bsxfun(@minus, <span class="var type1" id="S40T9U871">E1</span>, <span class="mxinfo " id="T11:U629">min(<span class="var type1" id="S40T9U874">E1</span>)</span>)</span></span>;  <span class="comment">% Normalization</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156">156</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157">157</a></span><span class="line">        <span class="comment">% 2.4 Message from the equality factor update</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158">158</a></span><span class="line">        <span class="mxinfo " id="T9:U631"><span class="var type1" id="S46T9U877">mu_eq</span> = <span class="mxinfo " id="T9:U633"><span class="var type1" id="S40T9U879">E1</span> + <span class="var type1" id="S23T9U880">q</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line">        <span class="mxinfo " id="T9:U636"><span class="var type1" id="S46T9U883">mu_eq</span> = <span class="mxinfo " id="T9:U638">bsxfun(@minus, <span class="var type1" id="S46T9U888">mu_eq</span>, <span class="mxinfo " id="T11:U640">min(<span class="var type1" id="S46T9U891">mu_eq</span>)</span>)</span></span>;  <span class="comment">% Normalization</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line">        <span class="comment">% 3 BCJR ALGORITHM ON THE LOWER CODE</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162">162</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163">163</a></span><span class="line">        <span class="comment">% 3.0 BCJR matrices initialization </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164">164</a></span><span class="line">        <span class="mxinfo " id="T12:U642"><span class="var type1" id="S42T12U894">backward_matrix</span> = <span class="mxinfo " id="T12:U644">Inf(<span class="mxinfo " id="T10:U645">2^<span class="var type1" id="S16T5U899">crsc_v</span></span>, <span class="var type1" id="S9T5U900">N</span>)</span></span>;   <span class="comment">% Row: state  | Column: step l</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165">165</a></span><span class="line">        <span class="mxinfo " id="T12:U648"><span class="var type1" id="S44T12U903">forward_matrix</span> = <span class="mxinfo " id="T12:U650">Inf(<span class="mxinfo " id="T5:U651">2^<span class="var type1" id="S16T5U908">crsc_v</span></span>, <span class="var type1" id="S9T5U909">N</span>)</span></span>;    <span class="comment">% Row: state  | Column: step l</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166">166</a></span><span class="line">        <span class="mxinfo " id="T9:U654"><span class="var type1" id="S45T9U912">extrinsic_matrix</span> = <span class="mxinfo " id="T9:U656">Inf(<span class="mxinfo " id="T5:U657">2^<span class="var type1" id="S14T5U917">crsc_k</span></span>, <span class="var type1" id="S9T5U918">N</span>)</span></span>;  <span class="comment">% Row: input  | Column: step l</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167">167</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,168" id="srcline168">168</a></span><span class="line">        <span class="comment">% 3.1 Backward message update</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line">        <span class="mxinfo " id="T5:U660"><span class="mxinfo " id="T5:U661"><span class="var type1" id="S42T12U922">backward_matrix</span>(<span class="mxinfo " id="T5:U663">1</span>,<span class="mxinfo " id="T5:U664">end</span>)</span> = <span class="mxinfo " id="T5:U665">0</span></span>; <span class="comment">% Starting with B_(N-1)(s_0) = 0 </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170">170</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S34T5U929">l</span> = <span class="mxinfo " id="T5:U667"><span class="mxinfo " id="T5:U668"><span class="mxinfo " id="T5:U669">2</span>*<span class="var type1" id="S9T5U935">N</span></span>-<span class="mxinfo " id="T5:U671">1</span></span> : <span class="mxinfo " id="T5:U672">-1</span> : <span class="mxinfo " id="T5:U673">1</span>      <span class="comment">% This is a matlab matrix index</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171">171</a></span><span class="line">            <span class="mxinfo " id="T5:U674"><span class="var type1" id="S47T5U942">index</span> = <span class="mxinfo " id="T5:U676">mod(<span class="var type1" id="S34T5U945">l</span>,<span class="var type1" id="S9T5U946">N</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172">172</a></span><span class="line">            <span class="keyword">for</span> <span class="var type1" id="S49T5U949">s</span> = <span class="mxinfo " id="T5:U680">0</span> : 2^<span class="var type1" id="S16T5U955">crsc_v</span> - 1  <span class="comment">% s_l</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173">173</a></span><span class="line">                <span class="mxinfo " id="T5:U682"><span class="var type1" id="S50T5U959">minimum</span> = <span class="mxinfo " id="T5:U684">Inf</span></span>;       <span class="comment">% Sum over u </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174">174</a></span><span class="line">                <span class="keyword">for</span> <span class="var type1" id="S51T5U964">u</span> = <span class="mxinfo " id="T5:U686">0</span> : 2^<span class="var type1" id="S14T5U970">crsc_k</span> - 1 </span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175">175</a></span><span class="line">                    <span class="mxinfo " id="T5:U688"><span class="var type1" id="S52T5U974">ql_u</span> = <span class="mxinfo " id="T5:U690"><span class="var type1" id="S46T9U976">mu_eq</span>(<span class="mxinfo " id="T5:U692"><span class="mxinfo " id="T5:U693"><span class="var type1" id="S11T6U979">p_input_table</span>(<span class="mxinfo " id="T5:U695"><span class="var type1" id="S51T5U981">u</span>+<span class="mxinfo " id="T5:U697">1</span></span>, <span class="mxinfo " id="T5:U698"><span class="var type1" id="S47T5U984">index</span>+<span class="mxinfo " id="T5:U700">1</span></span>)</span>+<span class="mxinfo " id="T5:U701">1</span></span>, <span class="mxinfo " id="T5:U702"><span class="mxinfo " id="T5:U703"><span class="var type1" id="S12T6U989">p_step_table</span>(<span class="mxinfo " id="T5:U705"><span class="var type1" id="S51T5U991">u</span>+<span class="mxinfo " id="T5:U707">1</span></span>,<span class="mxinfo " id="T5:U708"><span class="var type1" id="S47T5U994">index</span>+<span class="mxinfo " id="T5:U710">1</span></span>)</span>+<span class="mxinfo " id="T5:U711">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,176" id="srcline176">176</a></span><span class="line">                    <span class="mxinfo " id="T5:U712"><span class="var type1" id="S35T5U999">y</span> = <span class="mxinfo " id="T5:U714"><span class="var type1" id="S5T3U1001">output_table</span>(<span class="mxinfo " id="T5:U716"><span class="var type1" id="S49T5U1003">s</span>+<span class="mxinfo " id="T5:U718">1</span></span>, <span class="mxinfo " id="T5:U719"><span class="var type1" id="S51T5U1006">u</span>+<span class="mxinfo " id="T5:U721">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,177" id="srcline177">177</a></span><span class="line">                    <span class="mxinfo " id="T5:U722"><span class="var type1" id="S53T5U1010">gl_y</span> = <span class="mxinfo " id="T5:U724"><span class="var type1" id="S30T12U1012">g2</span>(<span class="mxinfo " id="T5:U726"><span class="var type1" id="S35T5U1014">y</span>+<span class="mxinfo " id="T5:U728">1</span></span>, <span class="mxinfo " id="T5:U729"><span class="var type1" id="S47T5U1017">index</span>+<span class="mxinfo " id="T5:U731">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,178" id="srcline178">178</a></span><span class="line">                    <span class="mxinfo " id="T5:U732"><span class="var type1" id="S54T5U1021">s_n</span>  = <span class="mxinfo " id="T5:U734"><span class="var type1" id="S4T3U1023">state_update_table</span>(<span class="mxinfo " id="T5:U736"><span class="var type1" id="S49T5U1025">s</span>+<span class="mxinfo " id="T5:U738">1</span></span>, <span class="mxinfo " id="T5:U739"><span class="var type1" id="S51T5U1028">u</span>+<span class="mxinfo " id="T5:U741">1</span></span>)</span></span>;    <span class="comment">% s_(l+1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,179" id="srcline179">179</a></span><span class="line">                    <span class="mxinfo " id="T5:U742"><span class="var type1" id="S55T5U1032">B_n</span> = <span class="mxinfo " id="T5:U744"><span class="var type1" id="S42T12U1034">backward_matrix</span>(<span class="mxinfo " id="T5:U746"><span class="var type1" id="S54T5U1036">s_n</span>+<span class="mxinfo " id="T5:U748">1</span></span>, <span class="mxinfo " id="T5:U749"><span class="var type1" id="S47T5U1039">index</span>+<span class="mxinfo " id="T5:U751">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,180" id="srcline180">180</a></span><span class="line">                    <span class="mxinfo " id="T5:U752"><span class="var type1" id="S56T5U1043">add</span> = <span class="mxinfo " id="T5:U754"><span class="mxinfo " id="T5:U755"><span class="var type1" id="S55T5U1046">B_n</span> + <span class="var type1" id="S53T5U1047">gl_y</span></span> + <span class="var type1" id="S52T5U1048">ql_u</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181">181</a></span><span class="line">                    <span class="comment">% TO IMPLEMENT: PIECEWISE CONSTANT APPROXIMATION</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182">182</a></span><span class="line">                    <span class="mxinfo " id="T5:U759"><span class="var type1" id="S50T5U1051">minimum</span> = <span class="mxinfo " id="T5:U761">min(<span class="mxinfo " id="T18:U762">[<span class="var type1" id="S50T5U1056">minimum</span>, <span class="var type1" id="S56T5U1057">add</span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,183" id="srcline183">183</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,184" id="srcline184">184</a></span><span class="line">                <span class="keyword">if</span> <span class="mxinfo " id="T8:U765"><span class="var type1" id="S47T5U1061">index</span> == <span class="mxinfo " id="T5:U767">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,185" id="srcline185">185</a></span><span class="line">                    <span class="mxinfo " id="T5:U768"><span class="var type1" id="S57T5U1065">index2</span> = <span class="var type1" id="S9T5U1066">N</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,186" id="srcline186">186</a></span><span class="line">                <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,187" id="srcline187">187</a></span><span class="line">                    <span class="mxinfo " id="T5:U771"><span class="var type1" id="S57T5U1070">index2</span> = <span class="var type1" id="S47T5U1071">index</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,188" id="srcline188">188</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,189" id="srcline189">189</a></span><span class="line">                <span class="mxinfo " id="T5:U774"><span class="mxinfo " id="T5:U775"><span class="var type1" id="S42T12U1075">backward_matrix</span>(<span class="mxinfo " id="T5:U777"><span class="var type1" id="S49T5U1077">s</span>+<span class="mxinfo " id="T5:U779">1</span></span>, <span class="var type1" id="S57T5U1079">index2</span>)</span> = <span class="var type1" id="S50T5U1080">minimum</span></span>;           </span></span>
<span class="srcline"><span class="lineno"><a href="1,190" id="srcline190">190</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,191" id="srcline191">191</a></span><span class="line">            <span class="mxinfo " id="T19:U782"><span class="mxinfo " id="T19:U783"><span class="var type1" id="S42T12U1084">backward_matrix</span>(<span class="mxinfo " id="T20:U785">:</span>, <span class="var type1" id="S57T5U1086">index2</span>)</span> = <span class="mxinfo " id="T19:U787"><span class="mxinfo " id="T19:U788"><span class="var type1" id="S42T12U1089">backward_matrix</span>(<span class="mxinfo " id="T20:U790">:</span>, <span class="var type1" id="S57T5U1091">index2</span>)</span> <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,192" id="srcline192">192</a></span><span class="line">                         - <span class="mxinfo " id="T5:U792">min(<span class="mxinfo " id="T19:U793"><span class="var type1" id="S42T12U1095">backward_matrix</span>(<span class="mxinfo " id="T20:U795">:</span>, <span class="var type1" id="S57T5U1097">index2</span>)</span>)</span></span></span>; <span class="comment">% Normalization</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,193" id="srcline193">193</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,194" id="srcline194">194</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,195" id="srcline195">195</a></span><span class="line">        <span class="comment">% 3.2 Forward messages update</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,196" id="srcline196">196</a></span><span class="line">        <span class="mxinfo " id="T5:U797"><span class="mxinfo " id="T5:U798"><span class="var type1" id="S44T12U1101">forward_matrix</span>(<span class="mxinfo " id="T5:U800">1</span>,<span class="mxinfo " id="T5:U801">1</span>)</span> = <span class="mxinfo " id="T5:U802">0</span></span>; <span class="comment">% Starting with F_0 (s_0) = 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,197" id="srcline197">197</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S34T5U1107">l</span> = <span class="mxinfo " id="T5:U804">2</span>:<span class="mxinfo " id="T5:U805"><span class="mxinfo " id="T5:U806">2</span>*<span class="var type1" id="S9T5U1112">N</span></span>            <span class="comment">% This is a matlab matrix index</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,198" id="srcline198">198</a></span><span class="line">            <span class="mxinfo " id="T5:U808"><span class="var type1" id="S47T5U1115">index</span> = <span class="mxinfo " id="T5:U810">mod(<span class="mxinfo " id="T5:U811"><span class="var type1" id="S34T5U1119">l</span>-<span class="mxinfo " id="T5:U813">1</span></span>, <span class="var type1" id="S9T5U1121">N</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,199" id="srcline199">199</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T8:U815"><span class="var type1" id="S47T5U1125">index</span> == <span class="mxinfo " id="T5:U817">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,200" id="srcline200">200</a></span><span class="line">                <span class="mxinfo " id="T5:U818"><span class="var type1" id="S57T5U1129">index2</span> = <span class="var type1" id="S9T5U1130">N</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,201" id="srcline201">201</a></span><span class="line">            <span class="keyword">else</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,202" id="srcline202">202</a></span><span class="line">                <span class="mxinfo " id="T5:U821"><span class="var type1" id="S57T5U1134">index2</span> = <span class="var type1" id="S47T5U1135">index</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,203" id="srcline203">203</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,204" id="srcline204">204</a></span><span class="line">            <span class="keyword">for</span> <span class="var type1" id="S49T5U1138">s</span> = <span class="mxinfo " id="T5:U825">0</span> : 2^<span class="var type1" id="S16T5U1144">crsc_v</span> - 1  <span class="comment">% s_(l+1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,205" id="srcline205">205</a></span><span class="line">                <span class="mxinfo " id="T5:U827"><span class="var type1" id="S50T5U1148">minimum</span> = <span class="mxinfo " id="T5:U829">Inf</span></span>;        <span class="comment">% Sum over the neighbours of s</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,206" id="srcline206">206</a></span><span class="line">                <span class="keyword">for</span> <span class="var type1" id="S58T5U1153">u_p</span> = <span class="mxinfo " id="T5:U831">0</span> : 2^<span class="var type1" id="S14T5U1159">crsc_k</span> - 1</span></span>
<span class="srcline"><span class="lineno"><a href="1,207" id="srcline207">207</a></span><span class="line">                    <span class="mxinfo " id="T5:U833"><span class="var type1" id="S52T5U1163">ql_u</span> = <span class="mxinfo " id="T5:U835"><span class="var type1" id="S46T9U1165">mu_eq</span>(<span class="mxinfo " id="T5:U837"><span class="mxinfo " id="T5:U838"><span class="var type1" id="S11T6U1168">p_input_table</span>(<span class="mxinfo " id="T5:U840"><span class="var type1" id="S58T5U1170">u_p</span>+<span class="mxinfo " id="T5:U842">1</span></span>,<span class="var type1" id="S57T5U1172">index2</span>)</span>+<span class="mxinfo " id="T5:U844">1</span></span>, <span class="mxinfo " id="T5:U845"><span class="mxinfo " id="T5:U846"><span class="var type1" id="S12T6U1176">p_step_table</span>(<span class="mxinfo " id="T5:U848"><span class="var type1" id="S58T5U1178">u_p</span>+<span class="mxinfo " id="T5:U850">1</span></span>,<span class="var type1" id="S57T5U1180">index2</span>)</span>+<span class="mxinfo " id="T5:U852">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,208" id="srcline208">208</a></span><span class="line">                    <span class="mxinfo " id="T5:U853"><span class="var type1" id="S59T5U1184">s_p</span> = <span class="mxinfo " id="T5:U855"><span class="var type1" id="S6T3U1186">neighbours_table</span>(<span class="mxinfo " id="T5:U857"><span class="var type1" id="S49T5U1188">s</span>+<span class="mxinfo " id="T5:U859">1</span></span>, <span class="mxinfo " id="T5:U860"><span class="var type1" id="S58T5U1191">u_p</span>+<span class="mxinfo " id="T5:U862">1</span></span>)</span></span>;  <span class="comment">% s_l</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,209" id="srcline209">209</a></span><span class="line">                    <span class="mxinfo " id="T5:U863"><span class="var type1" id="S35T5U1195">y</span> = <span class="mxinfo " id="T5:U865"><span class="var type1" id="S5T3U1197">output_table</span>(<span class="mxinfo " id="T5:U867"><span class="var type1" id="S59T5U1199">s_p</span>+<span class="mxinfo " id="T5:U869">1</span></span>, <span class="mxinfo " id="T5:U870"><span class="var type1" id="S58T5U1202">u_p</span>+<span class="mxinfo " id="T5:U872">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,210" id="srcline210">210</a></span><span class="line">                    <span class="mxinfo " id="T5:U873"><span class="var type1" id="S53T5U1206">gl_y</span> = <span class="mxinfo " id="T5:U875"><span class="var type1" id="S30T12U1208">g2</span>(<span class="mxinfo " id="T5:U877"><span class="var type1" id="S35T5U1210">y</span>+<span class="mxinfo " id="T5:U879">1</span></span>, <span class="var type1" id="S57T5U1212">index2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,211" id="srcline211">211</a></span><span class="line">                    <span class="mxinfo " id="T5:U881"><span class="var type1" id="S60T5U1215">F_p</span> = <span class="mxinfo " id="T5:U883"><span class="var type1" id="S44T12U1217">forward_matrix</span>(<span class="mxinfo " id="T5:U885"><span class="var type1" id="S59T5U1219">s_p</span>+<span class="mxinfo " id="T5:U887">1</span></span>, <span class="var type1" id="S57T5U1221">index2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,212" id="srcline212">212</a></span><span class="line">                    <span class="mxinfo " id="T5:U889"><span class="var type1" id="S56T5U1224">add</span> = <span class="mxinfo " id="T5:U891"><span class="mxinfo " id="T5:U892"><span class="var type1" id="S60T5U1227">F_p</span> + <span class="var type1" id="S53T5U1228">gl_y</span></span> + <span class="var type1" id="S52T5U1229">ql_u</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,213" id="srcline213">213</a></span><span class="line">                    <span class="comment">% TO IMPLEMENT: PIECEWISE CONSTANT APPROXIMATION</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,214" id="srcline214">214</a></span><span class="line">                    <span class="mxinfo " id="T5:U896"><span class="var type1" id="S50T5U1232">minimum</span> = <span class="mxinfo " id="T5:U898">min(<span class="mxinfo " id="T18:U899">[<span class="var type1" id="S50T5U1237">minimum</span>, <span class="var type1" id="S56T5U1238">add</span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,215" id="srcline215">215</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,216" id="srcline216">216</a></span><span class="line">                <span class="mxinfo " id="T5:U902"><span class="mxinfo " id="T5:U903"><span class="var type1" id="S44T12U1242">forward_matrix</span>(<span class="mxinfo " id="T5:U905"><span class="var type1" id="S49T5U1244">s</span>+<span class="mxinfo " id="T5:U907">1</span></span>, <span class="mxinfo " id="T5:U908"><span class="var type1" id="S47T5U1247">index</span>+<span class="mxinfo " id="T5:U910">1</span></span>)</span> = <span class="var type1" id="S50T5U1249">minimum</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,217" id="srcline217">217</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,218" id="srcline218">218</a></span><span class="line">            <span class="mxinfo " id="T19:U912"><span class="mxinfo " id="T19:U913"><span class="var type1" id="S44T12U1253">forward_matrix</span>(<span class="mxinfo " id="T20:U915">:</span>, <span class="mxinfo " id="T5:U916"><span class="var type1" id="S47T5U1256">index</span>+<span class="mxinfo " id="T5:U918">1</span></span>)</span> = <span class="mxinfo " id="T19:U919"><span class="mxinfo " id="T19:U920"><span class="var type1" id="S44T12U1260">forward_matrix</span>(<span class="mxinfo " id="T20:U922">:</span>, <span class="mxinfo " id="T5:U923"><span class="var type1" id="S47T5U1263">index</span>+<span class="mxinfo " id="T5:U925">1</span></span>)</span> - <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,219" id="srcline219">219</a></span><span class="line">                        <span class="mxinfo " id="T5:U926">min(<span class="mxinfo " id="T19:U927"><span class="var type1" id="S44T12U1268">forward_matrix</span>(<span class="mxinfo " id="T20:U929">:</span>, <span class="mxinfo " id="T5:U930"><span class="var type1" id="S47T5U1271">index</span>+<span class="mxinfo " id="T5:U932">1</span></span>)</span>)</span></span></span>; <span class="comment">% Normalization</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,220" id="srcline220">220</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,221" id="srcline221">221</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,222" id="srcline222">222</a></span><span class="line">        <span class="comment">% 3.3 Extrinsic message update</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,223" id="srcline223">223</a></span><span class="line">        <span class="mxinfo " id="T5:U933"><span class="var type1" id="S61T5U1275">index_b</span> = <span class="mxinfo " id="T5:U935">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,224" id="srcline224">224</a></span><span class="line">        <span class="mxinfo " id="T5:U936"><span class="var type1" id="S62T5U1279">index_f</span> = <span class="mxinfo " id="T5:U938">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,225" id="srcline225">225</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S34T5U1283">l</span> = <span class="mxinfo " id="T5:U940">1</span> : <span class="var type1" id="S9T5U1286">N</span>                             <span class="comment">% This is a matlab index!</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,226" id="srcline226">226</a></span><span class="line">            <span class="keyword">for</span> <span class="var type1" id="S51T5U1289">u</span> = <span class="mxinfo " id="T5:U943">0</span> : 2^<span class="var type1" id="S14T5U1295">crsc_k</span> -1</span></span>
<span class="srcline"><span class="lineno"><a href="1,227" id="srcline227">227</a></span><span class="line">                <span class="mxinfo " id="T5:U945"><span class="var type1" id="S50T5U1299">minimum</span> = <span class="mxinfo " id="T5:U947">Inf</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,228" id="srcline228">228</a></span><span class="line">                <span class="keyword">for</span> <span class="var type1" id="S49T5U1304">s</span> = <span class="mxinfo " id="T5:U949">0</span> : 2^<span class="var type1" id="S16T5U1310">crsc_v</span> -1</span></span>
<span class="srcline"><span class="lineno"><a href="1,229" id="srcline229">229</a></span><span class="line">                    <span class="mxinfo " id="T5:U951"><span class="var type1" id="S54T5U1314">s_n</span> = <span class="mxinfo " id="T5:U953"><span class="var type1" id="S4T3U1316">state_update_table</span>(<span class="mxinfo " id="T5:U955"><span class="var type1" id="S49T5U1318">s</span>+<span class="mxinfo " id="T5:U957">1</span></span>, <span class="mxinfo " id="T5:U958"><span class="var type1" id="S51T5U1321">u</span>+<span class="mxinfo " id="T5:U960">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,230" id="srcline230">230</a></span><span class="line">                    <span class="mxinfo " id="T5:U961"><span class="var type1" id="S35T5U1325">y</span> = <span class="mxinfo " id="T5:U963"><span class="var type1" id="S5T3U1327">output_table</span>(<span class="mxinfo " id="T5:U965"><span class="var type1" id="S49T5U1329">s</span>+<span class="mxinfo " id="T5:U967">1</span></span>, <span class="mxinfo " id="T5:U968"><span class="var type1" id="S51T5U1332">u</span>+<span class="mxinfo " id="T5:U970">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,231" id="srcline231">231</a></span><span class="line">                    <span class="mxinfo " id="T5:U971"><span class="var type1" id="S53T5U1336">gl_y</span> = <span class="mxinfo " id="T5:U973"><span class="var type1" id="S30T12U1338">g2</span>(<span class="mxinfo " id="T5:U975"><span class="var type1" id="S35T5U1340">y</span>+<span class="mxinfo " id="T5:U977">1</span></span>, <span class="var type1" id="S34T5U1342">l</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,232" id="srcline232">232</a></span><span class="line">                    <span class="mxinfo " id="T5:U979"><span class="var type1" id="S63T5U1345">F</span> = <span class="mxinfo " id="T5:U981"><span class="var type1" id="S44T12U1347">forward_matrix</span>(<span class="mxinfo " id="T5:U983"><span class="var type1" id="S49T5U1349">s</span>+<span class="mxinfo " id="T5:U985">1</span></span>, <span class="var type1" id="S62T5U1351">index_f</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,233" id="srcline233">233</a></span><span class="line">                    <span class="mxinfo " id="T5:U987"><span class="var type1" id="S64T5U1354">B</span> = <span class="mxinfo " id="T5:U989"><span class="var type1" id="S42T12U1356">backward_matrix</span>(<span class="mxinfo " id="T5:U991"><span class="var type1" id="S54T5U1358">s_n</span>+<span class="mxinfo " id="T5:U993">1</span></span>, <span class="var type1" id="S61T5U1360">index_b</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,234" id="srcline234">234</a></span><span class="line">                    <span class="mxinfo " id="T5:U995"><span class="var type1" id="S56T5U1363">add</span> = <span class="mxinfo " id="T5:U997"><span class="mxinfo " id="T5:U998"><span class="var type1" id="S63T5U1366">F</span> + <span class="var type1" id="S64T5U1367">B</span></span> + <span class="var type1" id="S53T5U1368">gl_y</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,235" id="srcline235">235</a></span><span class="line">                    <span class="comment">% TO IMPLEMENT: PIECEWISE CONSTANT APPROXIMATION</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,236" id="srcline236">236</a></span><span class="line">                    <span class="mxinfo " id="T5:U1002"><span class="var type1" id="S50T5U1371">minimum</span> = <span class="mxinfo " id="T5:U1004">min(<span class="mxinfo " id="T18:U1005">[<span class="var type1" id="S50T5U1376">minimum</span>, <span class="var type1" id="S56T5U1377">add</span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,237" id="srcline237">237</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,238" id="srcline238">238</a></span><span class="line">                <span class="comment">%extrinsic_matrix(u+1, l) = summ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,239" id="srcline239">239</a></span><span class="line">                <span class="mxinfo " id="T5:U1008"><span class="mxinfo " id="T5:U1009"><span class="var type1" id="S45T9U1381">extrinsic_matrix</span>(<span class="mxinfo " id="T5:U1011"><span class="mxinfo " id="T5:U1012"><span class="var type1" id="S11T6U1384">p_input_table</span>(<span class="mxinfo " id="T5:U1014"><span class="var type1" id="S51T5U1386">u</span>+<span class="mxinfo " id="T5:U1016">1</span></span>,<span class="var type1" id="S34T5U1388">l</span>)</span>+<span class="mxinfo " id="T5:U1018">1</span></span>, <span class="mxinfo " id="T5:U1019"><span class="mxinfo " id="T5:U1020"><span class="var type1" id="S12T6U1392">p_step_table</span>(<span class="mxinfo " id="T5:U1022"><span class="var type1" id="S51T5U1394">u</span>+<span class="mxinfo " id="T5:U1024">1</span></span>,<span class="var type1" id="S34T5U1396">l</span>)</span>+<span class="mxinfo " id="T5:U1026">1</span></span>)</span> = <span class="var type1" id="S50T5U1398">minimum</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,240" id="srcline240">240</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,241" id="srcline241">241</a></span><span class="line">            <span class="mxinfo " id="T5:U1028"><span class="var type1" id="S62T5U1401">index_f</span> = <span class="mxinfo " id="T5:U1030"><span class="var type1" id="S62T5U1403">index_f</span> + <span class="mxinfo " id="T5:U1032">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,242" id="srcline242">242</a></span><span class="line">            <span class="mxinfo " id="T5:U1033"><span class="var type1" id="S61T5U1407">index_b</span> = <span class="mxinfo " id="T5:U1035"><span class="var type1" id="S61T5U1409">index_b</span> + <span class="mxinfo " id="T5:U1037">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,243" id="srcline243">243</a></span><span class="line">            <span class="comment">% index_b = mod(index_b + 1, N);        </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,244" id="srcline244">244</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,245" id="srcline245">245</a></span><span class="line">        <span class="mxinfo " id="T9:U1038"><span class="var type1" id="S39T9U1413">E2</span> = <span class="var type1" id="S45T9U1414">extrinsic_matrix</span></span>;  </span></span>
<span class="srcline"><span class="lineno"><a href="1,246" id="srcline246">246</a></span><span class="line">        <span class="mxinfo " id="T9:U1041"><span class="var type1" id="S39T9U1417">E2</span> = <span class="mxinfo " id="T9:U1043">bsxfun(@minus, <span class="var type1" id="S39T9U1422">E2</span>, <span class="mxinfo " id="T11:U1045">min(<span class="var type1" id="S39T9U1425">E2</span>)</span>)</span></span>;   <span class="comment">% Normalization</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,247" id="srcline247">247</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,248" id="srcline248">248</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,249" id="srcline249">249</a></span><span class="line">    <span class="comment">% Maximum a posteriori estimate</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,250" id="srcline250">250</a></span><span class="line">    [ <span class="mxinfo " id="T5:U1047">~</span> , <span class="var type1" id="S65T11U1430">u_hat_num</span> ] = min(<span class="mxinfo " id="T9:U1049"><span class="mxinfo " id="T9:U1050"><span class="var type1" id="S39T9U1435">E2</span>+<span class="var type1" id="S23T9U1436">q</span></span>+<span class="var type1" id="S40T9U1437">E1</span></span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,251" id="srcline251">251</a></span><span class="line">    <span class="mxinfo " id="T1:U1054"><span class="var type1" id="S2T1U1440">u_hat</span> = <span class="mxinfo " id="T1:U1056">zeros(<span class="mxinfo " id="T5:U1057"><span class="mxinfo " id="T5:U1058">length(<span class="var type1" id="S65T11U1446">u_hat_num</span>)</span> * <span class="var type1" id="S14T5U1447">crsc_k</span></span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,252" id="srcline252">252</a></span><span class="line">    <span class="comment">%num2input = @(i) mod(fix(i./(2.^(crsc_k-1:-1:0)).'),2);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,253" id="srcline253">253</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S21T5U1451">i</span> = <span class="mxinfo " id="T5:U1062">0</span> : <span class="mxinfo " id="T5:U1063"><span class="mxinfo " id="T5:U1064">length(<span class="var type1" id="S65T11U1457">u_hat_num</span>)</span>-<span class="mxinfo " id="T5:U1066">1</span></span>         <span class="comment">% From u_hat_num to u_hat</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,254" id="srcline254">254</a></span><span class="line">       <span class="comment">%u_hat(crsc_k*i+1:crsc_k*i+crsc_k) = num2input(u_hat_num(i+1)-1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,255" id="srcline255">255</a></span><span class="line">       <span class="mxinfo " id="T5:U1067"><span class="var type1" id="S67T5U1461">u_hat_num_i</span> = <span class="mxinfo " id="T5:U1069"><span class="mxinfo " id="T5:U1070"><span class="var type1" id="S65T11U1464">u_hat_num</span>(<span class="mxinfo " id="T5:U1072"><span class="var type1" id="S21T5U1466">i</span>+<span class="mxinfo " id="T5:U1074">1</span></span>)</span>-<span class="mxinfo " id="T5:U1075">1</span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,256" id="srcline256">256</a></span><span class="line">       <span class="mxinfo " id="T5:U1076"><span class="mxinfo " id="T5:U1077"><span class="var type1" id="S2T1U1472">u_hat</span>(<span class="mxinfo " id="T5:U1079"><span class="mxinfo " id="T5:U1080"><span class="var type1" id="S14T5U1475">crsc_k</span>*<span class="var type1" id="S21T5U1476">i</span></span>+<span class="mxinfo " id="T5:U1083">2</span></span>)</span> = <span class="mxinfo " id="T5:U1084">mod(<span class="var type1" id="S67T5U1480">u_hat_num_i</span>,<span class="mxinfo " id="T5:U1086">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,257" id="srcline257">257</a></span><span class="line">       <span class="mxinfo " id="T5:U1087"><span class="mxinfo " id="T5:U1088"><span class="var type1" id="S2T1U1485">u_hat</span>(<span class="mxinfo " id="T5:U1090"><span class="mxinfo " id="T5:U1091"><span class="var type1" id="S14T5U1488">crsc_k</span>*<span class="var type1" id="S21T5U1489">i</span></span>+<span class="mxinfo " id="T5:U1094">1</span></span>)</span> = <span class="mxinfo " id="T5:U1095">mod(<span class="mxinfo " id="T5:U1096">fix(<span class="mxinfo " id="T5:U1097"><span class="var type1" id="S67T5U1496">u_hat_num_i</span>/<span class="mxinfo " id="T5:U1099">2</span></span>)</span>,<span class="mxinfo " id="T5:U1100">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,258" id="srcline258">258</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,259" id="srcline259">259</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,260" id="srcline260">260</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,261" id="srcline261">261</a></span><span class="line"></span></span>
</pre>
